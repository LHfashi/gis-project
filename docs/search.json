[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Coup-Proofing via Capital Relocation",
    "section": "",
    "text": "Urban environments are complex landscapes where social, economic, and environmental factors intertwine to influence patterns of human activity, including crime. Among various crime types, carjackings represent a particularly concerning form of violent crime, as they often occur unexpectedly and pose significant risks to personal safety and public perception of security. Understanding the spatial distribution and underlying socioeconomic correlates of carjackings can offer valuable insights for policymakers, law enforcement, and urban planners aiming to reduce such incidents and improve community well-being.\nTopic and Data Selection:\nIn this project, we focus on the spatial analysis of carjacking incidents in Chicago, one of the largest and most diverse metropolitan areas in the United States. Chicago’s complex social geography—ranging from affluent downtown neighborhoods to underserved, lower-income communities—provides a rich context in which to examine how socioeconomic conditions may influence crime patterns. By investigating where and why carjackings cluster, we can move beyond general crime statistics and gain a more nuanced understanding of the local factors that shape crime risk.\nRationale for Choosing This Topic:\nCarjackings represent a type of crime that directly impacts both perceptions of public safety and the practical realities of transportation and mobility within a city. Unlike property crimes that may cluster around commercial zones or violent crimes that may concentrate in particular nightlife districts, carjackings can occur in residential neighborhoods, near transit hubs, or close to amenities like shopping centers and schools. Thus, examining carjackings offers a window into the interplay of social vulnerability, opportunity structures for offenders, and environmental conditions that collectively influence where and when these incidents happen.\nMoreover, by grounding the analysis in a city with well-documented socioeconomic disparities, we can test hypotheses that link crime not merely to place-based opportunities but also to structural inequalities. If lower-income areas not only experience more frequent carjackings (a “first-order” difference in intensity) but also show more pronounced clustering of these crimes at small scales (a “second-order” difference in spatial pattern), this suggests more than just higher crime rates—it indicates different underlying spatial processes and risk factors.\nProject Aims:\nIn the following sections, we will:\n- Define our hypotheses related to both first-order and second-order properties of the carjacking distribution.\n- Present initial evidence—both visual and statistical—to examine whether communities with lower median income indeed have higher carjacking densities, and whether these incidents are more spatially clustered in these areas.\n- Employ formal spatial analysis methods, including Ripley’s K-function with Monte Carlo simulations, to rigorously assess the significance of observed patterns.\n- Draw preliminary conclusions and propose a roadmap for further refinement of the analysis, potentially incorporating additional data layers, time-series perspectives, and more advanced spatial modeling techniques.\nBy the end of this project, we aim to demonstrate how GIS and spatial data science tools can provide critical insights into the spatial ecology of urban crime, offering a more informed basis for intervention strategies and long-term urban policy planning.\n\n\nBuilding on the context provided in the Introduction, we now turn to the core analytical questions guiding our investigation. Previously, we established the rationale for focusing on carjackings in Chicago and discussed the potential influence of socioeconomic factors, particularly median income, on the spatial distribution of crime. The next step is to formulate clear, testable hypotheses that bridge the conceptual groundwork with the GIS and spatial data science tools at our disposal.\nThe key premise is that not only might lower-income neighborhoods experience more frequent carjacking incidents, but these incidents may also be organized differently in space. To address this, we consider two types of spatial properties:\n\nFirst-Order Property (Intensity/Rate): How does the underlying intensity or density of incidents vary across space, independent of their arrangement relative to one another?\n\nSecond-Order Property (Spatial Clustering): How do events relate to each other in space? Do they form clusters or patterns at certain scales, above and beyond what could be explained by broad variation in area-level intensity?\n\nFirst-Order Hypothesis:\n- H1: Lower-income communities in Chicago have a higher density of carjackings than higher-income communities.\nThis hypothesis reflects the idea that socioeconomic disadvantage might directly correlate with elevated crime intensity. If data show that these neighborhoods consistently record more incidents per square kilometer, we will have initial evidence suggesting that limited resources or structural inequalities translate into greater vulnerability to crime.\nSecond-Order Hypothesis:\n- H2: In addition to higher overall densities, lower-income communities exhibit stronger local clustering of carjacking incidents at small spatial scales, relative to higher-income communities.\nWhile the first-order hypothesis addresses differences in the frequency of crime, the second-order hypothesis asks whether the crimes themselves tend to bunch together more tightly. A confirmation of this hypothesis would indicate that lower-income areas not only suffer from higher rates of carjacking, but that these incidents may also be more spatially concentrated into hotspots or micro-locations of heightened risk.\nWhy Both Properties Matter:\nExamining both first- and second-order properties provides a more complete picture of how socioeconomic factors shape crime patterns. A simple difference in density (H1) could be explained by area-wide conditions (e.g., fewer job opportunities, less robust policing, lower collective efficacy). However, if we also find that incidents cluster more intensely at small distances (H2), it suggests that the underlying spatial processes are more complex. Such findings might point to specific local factors—certain streets, intersections, or facilities within low-income areas—that generate recurring opportunities or incentives for offenders.\nBy articulating these two hypotheses, we set the stage for the subsequent analyses. In the sections that follow, we will present initial visual and statistical evidence, apply rigorous spatial analysis techniques (such as Ripley’s K-function and Monte Carlo simulations), and ultimately compare the observed patterns against these predicted spatial relationships. This approach allows us to move beyond broad claims and ground our conclusions in empirical spatial data, providing a more nuanced understanding of the interplay between socioeconomic conditions and urban crime.\n\n\n\nTo gain an initial understanding of how socioeconomic conditions—particularly median income—may influence carjacking patterns in Chicago, we present four complementary pieces of evidence. Each figure provides a unique perspective, from income classification and carjacking intensity to interactive exploration and formal spatial clustering analysis. Together, they guide our preliminary assessment of both the first-order (intensity) and second-order (clustering) hypotheses.\n\n\nFigure 1: Community Income Classification\n\n\n\nFigure 1: Communities by Income Group\n\n\nThis figure classifies Chicago’s communities into ‘low’ and ‘high’ median income groups relative to the city-wide median. Lighter turquoise hues indicate lower-income neighborhoods, and darker blues correspond to higher-income ones. While this map alone shows no crime data, it delineates the socioeconomic landscape. By pinpointing where lower-income areas lie, we set the spatial frame for subsequent comparisons with carjacking patterns.\n\n\n\nFigure 2: Carjackings Density per sq. km\n\n\n\nFigure 2: Carjackings Density\n\n\nIn this map, communities are shaded by their carjacking density (incidents per square kilometer). Darker reds signal higher densities. Comparing Figure 2 with Figure 1 reveals that many lower-income neighborhoods also appear in deeper red tones, suggesting elevated carjacking rates. This observation provides preliminary support for our first-order hypothesis—that less affluent communities tend to experience higher intensities of carjacking incidents.\n\n\n\nFigure 3: Interactive Map\nTo complement static maps, we developed an interactive folium-based visualization accessible via images/my_interactive_map.html. By opening this file in a web browser, one can hover over or click on any community to view its median income, carjacking count, computed density, and income group. This interactivity allows direct neighborhood-level inspection, making the observed relationship between low income and higher carjacking intensity more tangible and immediate. While this tool does not provide formal statistical validation, it reinforces and elucidates the patterns observed in Figures 1 and 2.\n\n\n\nFigure 4: Ripley’s K-function Analysis\n\n\n\nFigure 4: Ripley’s K Function\n\n\nTo address the second-order hypothesis—whether lower-income areas not only have more carjackings but also exhibit tighter spatial clustering—we employed Ripley’s K-function along with 999 Monte Carlo simulations. The observed K-function curve (red line) rising above the random envelope (gray band) indicates significant clustering of carjackings at multiple spatial scales. Preliminary subset analyses (not fully shown here) suggest that at smaller distances, lower-income communities show even stronger clustering. This supports the second-order hypothesis: in addition to having higher event frequencies, certain communities may experience more localized hotspots of crime.\n\n\n\n\nFirst-Order Evidence: Figures 1 and 2 together suggest that lower-income areas generally exhibit higher carjacking densities. The interactive exploration (Figure 3) further substantiates this pattern, allowing for intuitive and immediate verification on a community-by-community basis.\nSecond-Order Evidence: Figure 4’s K-function analysis reveals that carjackings are not randomly scattered; they cluster spatially. Evidence that such clustering intensifies in lower-income communities at smaller scales aligns with our second-order hypothesis, implying that socioeconomic disadvantage may shape not only the frequency but also the spatial arrangement of crimes.\n\nIn sum, these four pieces of evidence—income classification, density mapping, interactive inquiry, and spatial clustering analysis—provide a coherent preliminary picture. Lower-income neighborhoods appear more prone to both higher carjacking intensities and stronger clustering. Although these findings are preliminary and do not yet control for other factors (e.g., population density, policing intensity, temporal variations), they establish a promising foundation for further, more rigorous analyses. Future steps might involve integrating additional explanatory variables, conducting time-series assessments, and applying advanced spatial econometric models to refine these insights and guide more effective policy interventions.\n\n\n\n\nHaving established our initial visual insights, we now proceed to a more rigorous hypothesis-evaluation approach. Following the general template for formal spatial hypothesis testing, we:\n\nCompute and visualize the intensity function and/or pairwise correlation function for the observed data.\nBy focusing on Ripley’s K-function, we quantify how the observed carjacking incidents deviate from complete spatial randomness (CSR) across multiple distance scales. We have already identified broad clustering patterns, but now we refine this analysis to specifically compare lower-income and higher-income communities.\nRun 999 Monte Carlo simulations under the null hypothesis of CSR.\nUnder the null hypothesis, we assume that carjacking events in a given subset (e.g., low-income or high-income neighborhoods) are randomly distributed, given the same number of points and the same spatial domain. For each subset, we simulate 999 such patterns, computing the K-function for each. From these simulations, we construct an envelope representing the range of K-values we would expect under pure randomness.\nCompare the observed K-functions with those of the simulated patterns.\nIf the observed curve lies above the random envelope, it indicates more clustering than expected by chance; if it lies within or below, we cannot reject the null hypothesis of CSR.\n\n\n\nFigure 1: K-function for Low-Income Areas (images/c5.png)\n\nFor lower-income neighborhoods, the observed K-function (red line) consistently exceeds the upper boundary of the simulated envelope (gray band) at all examined distances. This suggests a significant departure from randomness—incidents in low-income areas are not only more frequent but also form tight clusters, particularly at smaller scales, as indicated by the steep initial rise in K-values.\nFigure 2: K-function for High-Income Areas (images/c6.png)\n\nHigh-income neighborhoods also show the observed K-function above the random envelope, signaling a statistically significant clustering of carjackings. However, by comparing the degree of clustering (vertical magnitude above the envelope) and the curvature at small distances, high-income areas seem to have less extreme clustering at the very smallest scales compared to low-income areas, though still significantly non-random.\nFigure 3: Normalized Comparison of K-functions (images/c7.png)\n\nTo facilitate direct comparison between low- and high-income areas, we normalize the observed K-values by the mean of the simulated distributions. A value above 1.0 implies more clustering than expected at random. At very short distances (e.g., &lt;1000m), the normalized K-function for low-income areas spikes dramatically, reaching levels around 7 times the random baseline. High-income areas also exceed the random baseline, but not as sharply, especially at the smallest scales. As distance increases, the difference between low- and high-income normalized K-values gradually diminishes, but both remain above the baseline, confirming the presence of clustering in both types of communities.\n\n\n\n\nFirst-Order Hypothesis (Higher Density in Lower-Income Areas):\nWhile the intensity of incidents (a first-order property) was initially suggested by simple density maps, these K-function analyses, along with Monte Carlo simulations, confirm that observed patterns are not solely a product of random fluctuations. The consistently higher-than-random K-values in low-income neighborhoods indicate that these areas do not just have more incidents per unit area—they also deviate significantly from a random spatial arrangement. This reinforces the idea that first-order differences in intensity are real and not a statistical artifact.\nSecond-Order Hypothesis (Stronger Clustering in Lower-Income Areas at Small Scales):\nThe low-income subset shows dramatically higher normalized K-values at short distances, indicating more intense clustering in micro-locations. This confirms that second-order properties are also at play: the spatial arrangement of incidents in lower-income areas is not just denser overall, but the points themselves are more tightly grouped than random processes would produce. While high-income neighborhoods also show clustering, the contrast in the normalized results strongly suggests that socioeconomic disadvantage intensifies the spatial concentration of crime at fine geographic scales.\n\n\n\n\nThese Monte Carlo-based K-function comparisons provide a rigorous statistical footing for our earlier visual observations. They validate both our first-order and second-order hypotheses:\n\nLower-income areas do experience higher incident intensities and more substantial clustering than would be expected under random conditions.\nHigh-income areas also show clustering, but the extreme small-scale clustering effect is more pronounced in lower-income neighborhoods.\n\nThus, the formal hypothesis-evaluation approach confirms and refines our initial conclusions, emphasizing the role socioeconomic conditions play in shaping not just how many carjacking events occur, but also their spatial configuration. Future work will focus on integrating additional covariates, exploring temporal patterns, and applying even more sophisticated spatial econometric models to further understand and interpret these results.\n\n\n\n\nTo improve the rigor and depth of our findings, several concrete steps must be taken. These next steps focus on enhancing data quality, incorporating additional variables, applying more advanced analytical methods, conducting comparative studies, and establishing stronger policy relevance. By systematically implementing these measures, we can refine our initial conclusions and provide more robust insights into the socioeconomic influences on the spatial distribution and clustering of carjackings.\n1. Improve Data Completeness and Temporal Coverage:\nThe current dataset lacks comprehensive incident records for certain neighborhoods and time periods. We will acquire additional historical records, ensuring consistent coverage across all communities and years under study. Incorporating finer temporal granularity (e.g., time-of-day, seasonal effects) will allow us to identify patterns that may vary over shorter time scales. These efforts ensure a more stable and representative dataset, thereby increasing confidence in the derived conclusions.\n2. Integrate Richer Socioeconomic and Environmental Indicators:\nCurrent analyses rely heavily on median income as a key socioeconomic variable. To better isolate income effects, we will include population density, unemployment rates, age structures, educational attainment, and other demographic metrics. Moreover, adding environmental and infrastructural indicators—such as street lighting quality, the presence of public transit stops, major roads, and commercial hubs—will enable us to pinpoint local drivers of hotspots. By controlling for multiple factors, we can more accurately distinguish the role of income from other correlates and contextual conditions.\n3. Employ Advanced Spatial Statistical Techniques:\nWhile the K-function and basic Monte Carlo simulations provide initial confirmation of spatial clustering, we will apply local indicators of spatial association (LISA) and the Getis-Ord Gi* statistic to identify specific subregions or blocks driving the clustering patterns. Furthermore, spatial econometric models (e.g., spatial lag or spatial error models) and geographically weighted regression (GWR) will help disentangle complex spatial dependencies, yielding more precise estimates of how income levels shape both the intensity and the arrangement of carjackings.\n4. Conduct Comparative and Longitudinal Analyses:\nAnalyzing additional cities or extending the study period to multiple years enables us to test the stability and universality of the observed patterns. Observing changes over time and across different urban contexts strengthens the generalizability of our findings, revealing whether income-related clustering emerges as a consistent urban phenomenon or if it responds to evolving policies, economic shifts, or community initiatives.\n5. Link Findings to Policy and Intervention Strategies:\nBeyond academic interest, the ultimate goal is to inform practical interventions that enhance public safety. Identifying specific hotspots and understanding their socioeconomic drivers allows policymakers, law enforcement, and community organizations to target resource allocation more effectively. For instance, introducing improved street lighting, community policing initiatives, or economic development programs at identified hotspots may reduce both the frequency and clustering of carjackings. Continual monitoring of these interventions will clarify which strategies most effectively mitigate crime concentration in disadvantaged neighborhoods.\nIn sum, by improving data quality, broadening the range of explanatory variables, applying more sophisticated spatial methods, conducting cross-contextual comparisons, and aligning our insights with policy actions, we will transform these preliminary findings into a more comprehensive and actionable understanding of how socioeconomic disparities shape urban crime landscapes."
  },
  {
    "objectID": "index.html#hypothesis-development",
    "href": "index.html#hypothesis-development",
    "title": "Coup-Proofing via Capital Relocation",
    "section": "",
    "text": "Building on the context provided in the Introduction, we now turn to the core analytical questions guiding our investigation. Previously, we established the rationale for focusing on carjackings in Chicago and discussed the potential influence of socioeconomic factors, particularly median income, on the spatial distribution of crime. The next step is to formulate clear, testable hypotheses that bridge the conceptual groundwork with the GIS and spatial data science tools at our disposal.\nThe key premise is that not only might lower-income neighborhoods experience more frequent carjacking incidents, but these incidents may also be organized differently in space. To address this, we consider two types of spatial properties:\n\nFirst-Order Property (Intensity/Rate): How does the underlying intensity or density of incidents vary across space, independent of their arrangement relative to one another?\n\nSecond-Order Property (Spatial Clustering): How do events relate to each other in space? Do they form clusters or patterns at certain scales, above and beyond what could be explained by broad variation in area-level intensity?\n\nFirst-Order Hypothesis:\n- H1: Lower-income communities in Chicago have a higher density of carjackings than higher-income communities.\nThis hypothesis reflects the idea that socioeconomic disadvantage might directly correlate with elevated crime intensity. If data show that these neighborhoods consistently record more incidents per square kilometer, we will have initial evidence suggesting that limited resources or structural inequalities translate into greater vulnerability to crime.\nSecond-Order Hypothesis:\n- H2: In addition to higher overall densities, lower-income communities exhibit stronger local clustering of carjacking incidents at small spatial scales, relative to higher-income communities.\nWhile the first-order hypothesis addresses differences in the frequency of crime, the second-order hypothesis asks whether the crimes themselves tend to bunch together more tightly. A confirmation of this hypothesis would indicate that lower-income areas not only suffer from higher rates of carjacking, but that these incidents may also be more spatially concentrated into hotspots or micro-locations of heightened risk.\nWhy Both Properties Matter:\nExamining both first- and second-order properties provides a more complete picture of how socioeconomic factors shape crime patterns. A simple difference in density (H1) could be explained by area-wide conditions (e.g., fewer job opportunities, less robust policing, lower collective efficacy). However, if we also find that incidents cluster more intensely at small distances (H2), it suggests that the underlying spatial processes are more complex. Such findings might point to specific local factors—certain streets, intersections, or facilities within low-income areas—that generate recurring opportunities or incentives for offenders.\nBy articulating these two hypotheses, we set the stage for the subsequent analyses. In the sections that follow, we will present initial visual and statistical evidence, apply rigorous spatial analysis techniques (such as Ripley’s K-function and Monte Carlo simulations), and ultimately compare the observed patterns against these predicted spatial relationships. This approach allows us to move beyond broad claims and ground our conclusions in empirical spatial data, providing a more nuanced understanding of the interplay between socioeconomic conditions and urban crime."
  },
  {
    "objectID": "index.html#preliminary-analysis-and-initial-conclusions",
    "href": "index.html#preliminary-analysis-and-initial-conclusions",
    "title": "Coup-Proofing via Capital Relocation",
    "section": "",
    "text": "To gain an initial understanding of how socioeconomic conditions—particularly median income—may influence carjacking patterns in Chicago, we present four complementary pieces of evidence. Each figure provides a unique perspective, from income classification and carjacking intensity to interactive exploration and formal spatial clustering analysis. Together, they guide our preliminary assessment of both the first-order (intensity) and second-order (clustering) hypotheses.\n\n\nFigure 1: Community Income Classification\n\n\n\nFigure 1: Communities by Income Group\n\n\nThis figure classifies Chicago’s communities into ‘low’ and ‘high’ median income groups relative to the city-wide median. Lighter turquoise hues indicate lower-income neighborhoods, and darker blues correspond to higher-income ones. While this map alone shows no crime data, it delineates the socioeconomic landscape. By pinpointing where lower-income areas lie, we set the spatial frame for subsequent comparisons with carjacking patterns.\n\n\n\nFigure 2: Carjackings Density per sq. km\n\n\n\nFigure 2: Carjackings Density\n\n\nIn this map, communities are shaded by their carjacking density (incidents per square kilometer). Darker reds signal higher densities. Comparing Figure 2 with Figure 1 reveals that many lower-income neighborhoods also appear in deeper red tones, suggesting elevated carjacking rates. This observation provides preliminary support for our first-order hypothesis—that less affluent communities tend to experience higher intensities of carjacking incidents.\n\n\n\nFigure 3: Interactive Map\nTo complement static maps, we developed an interactive folium-based visualization accessible via images/my_interactive_map.html. By opening this file in a web browser, one can hover over or click on any community to view its median income, carjacking count, computed density, and income group. This interactivity allows direct neighborhood-level inspection, making the observed relationship between low income and higher carjacking intensity more tangible and immediate. While this tool does not provide formal statistical validation, it reinforces and elucidates the patterns observed in Figures 1 and 2.\n\n\n\nFigure 4: Ripley’s K-function Analysis\n\n\n\nFigure 4: Ripley’s K Function\n\n\nTo address the second-order hypothesis—whether lower-income areas not only have more carjackings but also exhibit tighter spatial clustering—we employed Ripley’s K-function along with 999 Monte Carlo simulations. The observed K-function curve (red line) rising above the random envelope (gray band) indicates significant clustering of carjackings at multiple spatial scales. Preliminary subset analyses (not fully shown here) suggest that at smaller distances, lower-income communities show even stronger clustering. This supports the second-order hypothesis: in addition to having higher event frequencies, certain communities may experience more localized hotspots of crime.\n\n\n\n\nFirst-Order Evidence: Figures 1 and 2 together suggest that lower-income areas generally exhibit higher carjacking densities. The interactive exploration (Figure 3) further substantiates this pattern, allowing for intuitive and immediate verification on a community-by-community basis.\nSecond-Order Evidence: Figure 4’s K-function analysis reveals that carjackings are not randomly scattered; they cluster spatially. Evidence that such clustering intensifies in lower-income communities at smaller scales aligns with our second-order hypothesis, implying that socioeconomic disadvantage may shape not only the frequency but also the spatial arrangement of crimes.\n\nIn sum, these four pieces of evidence—income classification, density mapping, interactive inquiry, and spatial clustering analysis—provide a coherent preliminary picture. Lower-income neighborhoods appear more prone to both higher carjacking intensities and stronger clustering. Although these findings are preliminary and do not yet control for other factors (e.g., population density, policing intensity, temporal variations), they establish a promising foundation for further, more rigorous analyses. Future steps might involve integrating additional explanatory variables, conducting time-series assessments, and applying advanced spatial econometric models to refine these insights and guide more effective policy interventions."
  },
  {
    "objectID": "index.html#formal-hypothesis-evaluation",
    "href": "index.html#formal-hypothesis-evaluation",
    "title": "Coup-Proofing via Capital Relocation",
    "section": "",
    "text": "Having established our initial visual insights, we now proceed to a more rigorous hypothesis-evaluation approach. Following the general template for formal spatial hypothesis testing, we:\n\nCompute and visualize the intensity function and/or pairwise correlation function for the observed data.\nBy focusing on Ripley’s K-function, we quantify how the observed carjacking incidents deviate from complete spatial randomness (CSR) across multiple distance scales. We have already identified broad clustering patterns, but now we refine this analysis to specifically compare lower-income and higher-income communities.\nRun 999 Monte Carlo simulations under the null hypothesis of CSR.\nUnder the null hypothesis, we assume that carjacking events in a given subset (e.g., low-income or high-income neighborhoods) are randomly distributed, given the same number of points and the same spatial domain. For each subset, we simulate 999 such patterns, computing the K-function for each. From these simulations, we construct an envelope representing the range of K-values we would expect under pure randomness.\nCompare the observed K-functions with those of the simulated patterns.\nIf the observed curve lies above the random envelope, it indicates more clustering than expected by chance; if it lies within or below, we cannot reject the null hypothesis of CSR.\n\n\n\nFigure 1: K-function for Low-Income Areas (images/c5.png)\n\nFor lower-income neighborhoods, the observed K-function (red line) consistently exceeds the upper boundary of the simulated envelope (gray band) at all examined distances. This suggests a significant departure from randomness—incidents in low-income areas are not only more frequent but also form tight clusters, particularly at smaller scales, as indicated by the steep initial rise in K-values.\nFigure 2: K-function for High-Income Areas (images/c6.png)\n\nHigh-income neighborhoods also show the observed K-function above the random envelope, signaling a statistically significant clustering of carjackings. However, by comparing the degree of clustering (vertical magnitude above the envelope) and the curvature at small distances, high-income areas seem to have less extreme clustering at the very smallest scales compared to low-income areas, though still significantly non-random.\nFigure 3: Normalized Comparison of K-functions (images/c7.png)\n\nTo facilitate direct comparison between low- and high-income areas, we normalize the observed K-values by the mean of the simulated distributions. A value above 1.0 implies more clustering than expected at random. At very short distances (e.g., &lt;1000m), the normalized K-function for low-income areas spikes dramatically, reaching levels around 7 times the random baseline. High-income areas also exceed the random baseline, but not as sharply, especially at the smallest scales. As distance increases, the difference between low- and high-income normalized K-values gradually diminishes, but both remain above the baseline, confirming the presence of clustering in both types of communities.\n\n\n\n\nFirst-Order Hypothesis (Higher Density in Lower-Income Areas):\nWhile the intensity of incidents (a first-order property) was initially suggested by simple density maps, these K-function analyses, along with Monte Carlo simulations, confirm that observed patterns are not solely a product of random fluctuations. The consistently higher-than-random K-values in low-income neighborhoods indicate that these areas do not just have more incidents per unit area—they also deviate significantly from a random spatial arrangement. This reinforces the idea that first-order differences in intensity are real and not a statistical artifact.\nSecond-Order Hypothesis (Stronger Clustering in Lower-Income Areas at Small Scales):\nThe low-income subset shows dramatically higher normalized K-values at short distances, indicating more intense clustering in micro-locations. This confirms that second-order properties are also at play: the spatial arrangement of incidents in lower-income areas is not just denser overall, but the points themselves are more tightly grouped than random processes would produce. While high-income neighborhoods also show clustering, the contrast in the normalized results strongly suggests that socioeconomic disadvantage intensifies the spatial concentration of crime at fine geographic scales.\n\n\n\n\nThese Monte Carlo-based K-function comparisons provide a rigorous statistical footing for our earlier visual observations. They validate both our first-order and second-order hypotheses:\n\nLower-income areas do experience higher incident intensities and more substantial clustering than would be expected under random conditions.\nHigh-income areas also show clustering, but the extreme small-scale clustering effect is more pronounced in lower-income neighborhoods.\n\nThus, the formal hypothesis-evaluation approach confirms and refines our initial conclusions, emphasizing the role socioeconomic conditions play in shaping not just how many carjacking events occur, but also their spatial configuration. Future work will focus on integrating additional covariates, exploring temporal patterns, and applying even more sophisticated spatial econometric models to further understand and interpret these results."
  },
  {
    "objectID": "index.html#roadmap-for-further-exploration-and-refinement",
    "href": "index.html#roadmap-for-further-exploration-and-refinement",
    "title": "Coup-Proofing via Capital Relocation",
    "section": "",
    "text": "To improve the rigor and depth of our findings, several concrete steps must be taken. These next steps focus on enhancing data quality, incorporating additional variables, applying more advanced analytical methods, conducting comparative studies, and establishing stronger policy relevance. By systematically implementing these measures, we can refine our initial conclusions and provide more robust insights into the socioeconomic influences on the spatial distribution and clustering of carjackings.\n1. Improve Data Completeness and Temporal Coverage:\nThe current dataset lacks comprehensive incident records for certain neighborhoods and time periods. We will acquire additional historical records, ensuring consistent coverage across all communities and years under study. Incorporating finer temporal granularity (e.g., time-of-day, seasonal effects) will allow us to identify patterns that may vary over shorter time scales. These efforts ensure a more stable and representative dataset, thereby increasing confidence in the derived conclusions.\n2. Integrate Richer Socioeconomic and Environmental Indicators:\nCurrent analyses rely heavily on median income as a key socioeconomic variable. To better isolate income effects, we will include population density, unemployment rates, age structures, educational attainment, and other demographic metrics. Moreover, adding environmental and infrastructural indicators—such as street lighting quality, the presence of public transit stops, major roads, and commercial hubs—will enable us to pinpoint local drivers of hotspots. By controlling for multiple factors, we can more accurately distinguish the role of income from other correlates and contextual conditions.\n3. Employ Advanced Spatial Statistical Techniques:\nWhile the K-function and basic Monte Carlo simulations provide initial confirmation of spatial clustering, we will apply local indicators of spatial association (LISA) and the Getis-Ord Gi* statistic to identify specific subregions or blocks driving the clustering patterns. Furthermore, spatial econometric models (e.g., spatial lag or spatial error models) and geographically weighted regression (GWR) will help disentangle complex spatial dependencies, yielding more precise estimates of how income levels shape both the intensity and the arrangement of carjackings.\n4. Conduct Comparative and Longitudinal Analyses:\nAnalyzing additional cities or extending the study period to multiple years enables us to test the stability and universality of the observed patterns. Observing changes over time and across different urban contexts strengthens the generalizability of our findings, revealing whether income-related clustering emerges as a consistent urban phenomenon or if it responds to evolving policies, economic shifts, or community initiatives.\n5. Link Findings to Policy and Intervention Strategies:\nBeyond academic interest, the ultimate goal is to inform practical interventions that enhance public safety. Identifying specific hotspots and understanding their socioeconomic drivers allows policymakers, law enforcement, and community organizations to target resource allocation more effectively. For instance, introducing improved street lighting, community policing initiatives, or economic development programs at identified hotspots may reduce both the frequency and clustering of carjackings. Continual monitoring of these interventions will clarify which strategies most effectively mitigate crime concentration in disadvantaged neighborhoods.\nIn sum, by improving data quality, broadening the range of explanatory variables, applying more sophisticated spatial methods, conducting cross-contextual comparisons, and aligning our insights with policy actions, we will transform these preliminary findings into a more comprehensive and actionable understanding of how socioeconomic disparities shape urban crime landscapes."
  },
  {
    "objectID": "11.html",
    "href": "11.html",
    "title": "",
    "section": "",
    "text": "import geopandas as gpd\nimport pandas as pd\n\n\ncarjackings_path = \"data/Chi_Carjackings/Chicago_Carjackings.shp\"\ncommunity_areas_path = \"data/Chi-CCA/Chicago_2020.shp\"\ncarjacking_variables_path = \"data/Chi_Carjackings/carjacking_variables.xlsx\"\n\n\n# 加载劫车事件点数据（点要素）\ngdf_carjackings = gpd.read_file(carjackings_path)\n\n# 加载芝加哥社区区块数据（面要素）\ngdf_community_areas = gpd.read_file(community_areas_path)\n\n\ndf_carjacking_vars = pd.read_excel(carjacking_variables_path)\n\n\n# 查看劫车数据结构\nprint(gdf_carjackings.head())\nprint(gdf_carjackings.info())\n\n# 查看社区数据结构\nprint(gdf_community_areas.head())\nprint(gdf_community_areas.info())\n\n# 查看变量表数据结构\nprint(df_carjacking_vars.head())\nprint(df_carjacking_vars.info())\n\n           ID Case _mber                    Date   IUCR  \\\n0  12243012.0   JD456735  12/11/2020 11:45:00 PM  326.0   \n1  12130750.0   JD326543  08/09/2020 08:30:00 PM  326.0   \n2  12012068.0   JD189121  03/18/2020 12:03:00 AM  326.0   \n3  12012705.0   JD189547  03/18/2020 01:00:00 PM  326.0   \n4  12013533.0   JD189766  03/18/2020 05:32:00 PM  325.0   \n\n                       Descr_tion   Locat_tion    Beat  District  Ward  \\\n0  AGGRAVATED VEHICULAR HIJACKING       STREET   723.0       7.0   6.0   \n1  AGGRAVATED VEHICULAR HIJACKING  GAS STATION  1234.0      12.0  25.0   \n2  AGGRAVATED VEHICULAR HIJACKING       STREET  1114.0      11.0  28.0   \n3  AGGRAVATED VEHICULAR HIJACKING       STREET  1114.0      11.0  28.0   \n4             VEHICULAR HIJACKING       STREET   712.0       7.0  16.0   \n\n   Commu_Area  FBI Code  X Coo_nate  Y Coo_nate   Latitude  Longitude  \\\n0        68.0       3.0   1171154.0   1859576.0  41.770145 -87.648175   \n1        31.0       3.0   1160694.0   1889888.0  41.853547 -87.685680   \n2        26.0       3.0   1147266.0   1900617.0  41.883256 -87.734691   \n3        26.0       3.0   1148374.0   1900366.0  41.882546 -87.730629   \n4        68.0       3.0   1171683.0   1864278.0  41.783036 -87.646098   \n\n                          geometry  \n0  POINT (1171154.000 1859576.000)  \n1  POINT (1160694.000 1889888.000)  \n2  POINT (1147266.000 1900617.000)  \n3  POINT (1148374.000 1900366.000)  \n4  POINT (1171683.000 1864278.000)  \n&lt;class 'geopandas.geodataframe.GeoDataFrame'&gt;\nRangeIndex: 1412 entries, 0 to 1411\nData columns (total 16 columns):\n #   Column      Non-Null Count  Dtype   \n---  ------      --------------  -----   \n 0   ID          1412 non-null   float64 \n 1   Case _mber  1412 non-null   object  \n 2   Date        1412 non-null   object  \n 3   IUCR        1412 non-null   float64 \n 4   Descr_tion  1412 non-null   object  \n 5   Locat_tion  1412 non-null   object  \n 6   Beat        1412 non-null   float64 \n 7   District    1412 non-null   float64 \n 8   Ward        1412 non-null   float64 \n 9   Commu_Area  1412 non-null   float64 \n 10  FBI Code    1412 non-null   float64 \n 11  X Coo_nate  1412 non-null   float64 \n 12  Y Coo_nate  1412 non-null   float64 \n 13  Latitude    1412 non-null   float64 \n 14  Longitude   1412 non-null   float64 \n 15  geometry    1412 non-null   geometry\ndtypes: float64(11), geometry(1), object(4)\nmemory usage: 176.6+ KB\nNone\n   area_num_1  area_numbe        community    shape_area     shape_len  \\\n0        35.0        35.0          DOUGLAS  4.600462e+07  31027.054510   \n1        36.0        36.0          OAKLAND  1.691396e+07  19565.506153   \n2        37.0        37.0      FULLER PARK  1.991670e+07  25339.089750   \n3        38.0        38.0  GRAND BOULEVARD  4.849250e+07  28196.837157   \n4        39.0        39.0          KENWOOD  2.907174e+07  23325.167906   \n\n   districtno    district  GEOID             GEOG  2000_POP  ...  KOREAN  \\\n0         7.0  South Side   35.0          Douglas   26470.0  ...   145.0   \n1         7.0  South Side   36.0          Oakland    6110.0  ...     0.0   \n2         7.0  South Side   37.0      Fuller Park    3420.0  ...     0.0   \n3         7.0  South Side   38.0  Grand Boulevard   28006.0  ...     0.0   \n4         7.0  South Side   39.0          Kenwood   18363.0  ...   124.0   \n\n   OTHASIAN  OTHER_EURO  OTHUNSPEC  2000_WHITE  2000_HISP  2000_BLACK  \\\n0     571.0      1290.0      555.0      1745.0      295.0     22635.0   \n1      22.0        98.0      342.0        40.0       58.0      5957.0   \n2       0.0        15.0        0.0        18.0      116.0      3225.0   \n3       0.0       258.0       83.0       173.0      236.0     27370.0   \n4     223.0       361.0      175.0      2915.0      301.0     13900.0   \n\n   2000_ASIAN  2000_OTHER                                           geometry  \n0      1390.0       405.0  POLYGON ((-87.60914 41.84469, -87.60915 41.844...  \n1         8.0        47.0  POLYGON ((-87.59215 41.81693, -87.59231 41.816...  \n2         6.0        55.0  POLYGON ((-87.62880 41.80189, -87.62879 41.801...  \n3        21.0       206.0  POLYGON ((-87.60671 41.81681, -87.60670 41.816...  \n4       785.0       462.0  POLYGON ((-87.59215 41.81693, -87.59215 41.816...  \n\n[5 rows x 217 columns]\n&lt;class 'geopandas.geodataframe.GeoDataFrame'&gt;\nRangeIndex: 77 entries, 0 to 76\nColumns: 217 entries, area_num_1 to geometry\ndtypes: float64(193), geometry(1), object(23)\nmemory usage: 130.7+ KB\nNone\n     Variable                            Description\n0          ID                    Internal identifier\n1   Case_mber                   Internal case number\n2        Date                       date of incident\n3        IUCR  Illinois Uniform Crime Reporting code\n4  Descr_tion                   incident description\n&lt;class 'pandas.core.frame.DataFrame'&gt;\nRangeIndex: 17 entries, 0 to 16\nData columns (total 2 columns):\n #   Column       Non-Null Count  Dtype \n---  ------       --------------  ----- \n 0   Variable     16 non-null     object\n 1   Description  15 non-null     object\ndtypes: object(2)\nmemory usage: 404.0+ bytes\nNone\n\n\n\n# 查看坐标参考系(CRS)\nprint(\"Carjackings CRS:\", gdf_carjackings.crs)\nprint(\"Community Areas CRS:\", gdf_community_areas.crs)\n\n# 如果二者不一致，可以将其中一个数据集重投影到另一个的CRS，例如：\n# gdf_carjackings = gdf_carjackings.to_crs(gdf_community_areas.crs)\n\n# 查看缺失值情况\nprint(\"\\nMissing values in carjackings data:\")\nprint(gdf_carjackings.isnull().sum())\n\nprint(\"\\nMissing values in community areas data:\")\nprint(gdf_community_areas.isnull().sum())\n\n# 检查几何对象类型\nprint(\"\\nCarjackings geometry type:\", gdf_carjackings.geom_type.unique())\nprint(\"Community Areas geometry type:\", gdf_community_areas.geom_type.unique())\n\n# 确保坐标存在且有效\nvalid_carjackings = gdf_carjackings[gdf_carjackings.geometry.notnull()]\nprint(\"\\nNumber of valid carjacking points:\", len(valid_carjackings))\nprint(\"Number of all carjacking points:\", len(gdf_carjackings))\n\n# 如果需要的话，还可以检查坐标范围，以确保数据大致在芝加哥范围内\nprint(\"\\nCarjackings bounding box:\", gdf_carjackings.total_bounds)\nprint(\"Community Areas bounding box:\", gdf_community_areas.total_bounds)\n\nCarjackings CRS: EPSG:3435\nCommunity Areas CRS: GEOGCS[\"unknown\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"Degree\",0.0174532925199433],AXIS[\"Longitude\",EAST],AXIS[\"Latitude\",NORTH]]\n\nMissing values in carjackings data:\nID            0\nCase _mber    0\nDate          0\nIUCR          0\nDescr_tion    0\nLocat_tion    0\nBeat          0\nDistrict      0\nWard          0\nCommu_Area    0\nFBI Code      0\nX Coo_nate    0\nY Coo_nate    0\nLatitude      0\nLongitude     0\ngeometry      0\ndtype: int64\n\nMissing values in community areas data:\narea_num_1    0\narea_numbe    0\ncommunity     0\nshape_area    0\nshape_len     0\n             ..\n2000_HISP     0\n2000_BLACK    0\n2000_ASIAN    0\n2000_OTHER    0\ngeometry      0\nLength: 217, dtype: int64\n\nCarjackings geometry type: ['Point']\nCommunity Areas geometry type: ['Polygon' 'MultiPolygon']\n\nNumber of valid carjacking points: 1412\nNumber of all carjacking points: 1412\n\nCarjackings bounding box: [1099640. 1816728. 1203211. 1950354.]\nCommunity Areas bounding box: [-87.94011408  41.64454312 -87.5241371   42.02303859]\n\n\n\n# 将Community Areas数据重投影为EPSG:3435\ngdf_community_areas = gdf_community_areas.to_crs(epsg=3435)\n\n# 检查结果\nprint(gdf_community_areas.crs)\n\nEPSG:3435\n\n\n\n# 使用sjoin进行空间连接\n# how='left'：保留carjackings中的所有点，from='carjackings'中返回其所属的community polygons\n# op='within'或'op='intersects'：由于点位于面内，所以可使用'within'匹配事件所在社区\ngdf_carjackings_joined = gpd.sjoin(gdf_carjackings, gdf_community_areas, how='left', predicate='within')\n\n# 检查结果\nprint(gdf_carjackings_joined.head())\nprint(gdf_carjackings_joined.crs)\n\n           ID Case _mber                    Date   IUCR  \\\n0  12243012.0   JD456735  12/11/2020 11:45:00 PM  326.0   \n1  12130750.0   JD326543  08/09/2020 08:30:00 PM  326.0   \n2  12012068.0   JD189121  03/18/2020 12:03:00 AM  326.0   \n3  12012705.0   JD189547  03/18/2020 01:00:00 PM  326.0   \n4  12013533.0   JD189766  03/18/2020 05:32:00 PM  325.0   \n\n                       Descr_tion   Locat_tion    Beat  District  Ward  \\\n0  AGGRAVATED VEHICULAR HIJACKING       STREET   723.0       7.0   6.0   \n1  AGGRAVATED VEHICULAR HIJACKING  GAS STATION  1234.0      12.0  25.0   \n2  AGGRAVATED VEHICULAR HIJACKING       STREET  1114.0      11.0  28.0   \n3  AGGRAVATED VEHICULAR HIJACKING       STREET  1114.0      11.0  28.0   \n4             VEHICULAR HIJACKING       STREET   712.0       7.0  16.0   \n\n   Commu_Area  ...  ARABIC  KOREAN  OTHASIAN  OTHER_EURO  OTHUNSPEC  \\\n0        68.0  ...     0.0     0.0       1.0        76.0      170.0   \n1        31.0  ...   203.0   186.0     136.0       256.0       82.0   \n2        26.0  ...     0.0     0.0       0.0        60.0       11.0   \n3        26.0  ...     0.0     0.0       0.0        60.0       11.0   \n4        68.0  ...     0.0     0.0       1.0        76.0      170.0   \n\n  2000_WHITE  2000_HISP  2000_BLACK  2000_ASIAN 2000_OTHER  \n0      178.0      347.0     39352.0        27.0      318.0  \n1     3587.0    39144.0       774.0       121.0      405.0  \n2      133.0      201.0     22564.0        18.0      103.0  \n3      133.0      201.0     22564.0        18.0      103.0  \n4      178.0      347.0     39352.0        27.0      318.0  \n\n[5 rows x 233 columns]\nEPSG:3435\n\n\n\n# 查看社区数据中的所有列名，找到中位收入字段名\nprint(gdf_community_areas.columns)\ngdf_community_areas['MEDINC'].describe()\nmedian_income = gdf_community_areas['MEDINC'].median()\nprint(\"Median income for all communities:\", median_income)\ngdf_community_areas['income_group'] = gdf_community_areas['MEDINC'].apply(lambda x: 'low' if x &lt; median_income else 'high')\n# 确保使用空间连接后的数据\n# 按照社区唯一标识字段（例如area_numbe或area_num_1）对事件计数\n# 注意替换'area_numbe'为实际标识社区的列名\nevent_counts = gdf_carjackings_joined.groupby('area_numbe').size().reset_index(name='carjackings_count')\n\n# 将事件数合并回社区数据\ngdf_community_areas = gdf_community_areas.merge(event_counts, on='area_numbe', how='left')\n\n# 对于没有劫车事件的社区，填充为0\ngdf_community_areas['carjackings_count'] = gdf_community_areas['carjackings_count'].fillna(0)\ngdf_community_areas['area_sqm'] = gdf_community_areas.geometry.area\ngdf_community_areas['carjackings_density'] = (gdf_community_areas['carjackings_count'] / (gdf_community_areas['area_sqm'] / 1_000_000))\nprint(gdf_community_areas[['area_numbe', 'MEDINC', 'income_group', 'carjackings_count', 'carjackings_density']].head())\n\nIndex(['area_num_1', 'area_numbe', 'community', 'shape_area', 'shape_len',\n       'districtno', 'district', 'GEOID', 'GEOG', '2000_POP',\n       ...\n       'KOREAN', 'OTHASIAN', 'OTHER_EURO', 'OTHUNSPEC', '2000_WHITE',\n       '2000_HISP', '2000_BLACK', '2000_ASIAN', '2000_OTHER', 'geometry'],\n      dtype='object', length=217)\nMedian income for all communities: 51689.0\n   area_numbe   MEDINC income_group  carjackings_count  carjackings_density\n0        35.0  31856.0          low               20.0             0.434738\n1        36.0  32844.0          low                4.0             0.236491\n2        37.0  23148.0          low                9.0             0.451881\n3        38.0  33503.0          low               31.0             0.639273\n4        39.0  49114.0          low               11.0             0.378374\n\n\n\nimport matplotlib.pyplot as plt\n\n# 可视化：根据income_group着色绘制社区分区\nfig, ax = plt.subplots(1, 1, figsize=(10, 10))\ngdf_community_areas.plot(column='income_group', categorical=True, legend=True, ax=ax)\nax.set_title('Chicago Communities by Income Group')\nax.axis('off')\nplt.show()\n\n# 可视化：根据carjackings_density绘制社区分区（连续值专题图）\nfig, ax = plt.subplots(1, 1, figsize=(10, 10))\ngdf_community_areas.plot(column='carjackings_density', cmap='OrRd', legend=True, ax=ax)\nax.set_title('Carjackings Density (per sq. km)')\nax.axis('off')\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport folium\nimport geopandas as gpd\n\ngdf_community_areas = gdf_community_areas.to_crs(epsg=4326)\n\nmean_lat = gdf_community_areas.geometry.centroid.y.mean()\nmean_lon = gdf_community_areas.geometry.centroid.x.mean()\n\nm = folium.Map(location=[mean_lat, mean_lon], zoom_start=10, tiles='cartodbpositron')\n\nfolium.Choropleth(\n    geo_data=gdf_community_areas,\n    data=gdf_community_areas,\n    columns=['community', 'carjackings_density'],\n    key_on='feature.properties.community',\n    fill_color='OrRd',\n    fill_opacity=0.7,\n    line_opacity=0.2,\n    legend_name='Carjackings Density (per sq. km)'\n).add_to(m)\n\ndef style_function(feature):\n    income_grp = feature['properties']['income_group']\n    color = 'blue' if income_grp == 'high' else 'green'\n    return {\n        'fillOpacity': 0,  # 不改变填充(底色已由choropleth确定)\n        'color': color,\n        'weight': 2\n    }\n\n# 准备在GeoJson中显示的字段信息（弹出或鼠标悬停时显示）\n# 例如显示 'community', 'MEDINC', 'carjackings_count', 'carjackings_density', 'income_group'\ntooltip_fields = ['community', 'MEDINC', 'carjackings_count', 'carjackings_density', 'income_group']\ntooltip_aliases = ['Community:', 'Median Income:', 'Carjacking Count:', 'Carjacking Density:', 'Income Group:']\n\n# 使用GeoJson叠加社区边界线并添加tooltip\nfolium.GeoJson(\n    gdf_community_areas,\n    name='Income Group Boundaries',\n    style_function=style_function,\n    tooltip=folium.GeoJsonTooltip(\n        fields=tooltip_fields,\n        aliases=tooltip_aliases,\n        localize=True\n    )\n).add_to(m)\n\nm\n\nC:\\Users\\huang\\AppData\\Local\\Temp\\ipykernel_8420\\2462306573.py:14: UserWarning: Geometry is in a geographic CRS. Results from 'centroid' are likely incorrect. Use 'GeoSeries.to_crs()' to re-project geometries to a projected CRS before this operation.\n\n  mean_lat = gdf_community_areas.geometry.centroid.y.mean()\nC:\\Users\\huang\\AppData\\Local\\Temp\\ipykernel_8420\\2462306573.py:15: UserWarning: Geometry is in a geographic CRS. Results from 'centroid' are likely incorrect. Use 'GeoSeries.to_crs()' to re-project geometries to a projected CRS before this operation.\n\n  mean_lon = gdf_community_areas.geometry.centroid.x.mean()\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\n\nm.save('my_interactive_map.html')\n\n\nimport geopandas as gpd\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom shapely.ops import unary_union\nfrom shapely.geometry import Point, Polygon\nimport pointpats\nfrom pointpats import distance_statistics as ds\n\n############################################\n# 1. 加载数据\n############################################\ncarjackings_path = \"data/Chi_Carjackings/Chicago_Carjackings.shp\"\ncommunity_areas_path = \"data/Chi-CCA/Chicago_2020.shp\"\ncarjacking_variables_path = \"data/Chi_Carjackings/carjacking_variables.xlsx\"\n\ngdf_carjackings = gpd.read_file(carjackings_path)\ngdf_community_areas = gpd.read_file(community_areas_path)\ndf_carjacking_vars = pd.read_excel(carjacking_variables_path)\n\n############################################\n# 2. 检查并统一CRS\n############################################\nprint(\"Carjackings CRS:\", gdf_carjackings.crs)\nprint(\"Community Areas CRS:\", gdf_community_areas.crs)\n\n# 如果CRS不一致，需要重投影。例如，劫车数据EPSG:3435，社区数据为地理坐标:\n# 假设以EPSG:3435为统一坐标系：\nif gdf_community_areas.crs != gdf_carjackings.crs:\n    gdf_community_areas = gdf_community_areas.to_crs(gdf_carjackings.crs)\n\nprint(\"After reprojecting, Community Areas CRS:\", gdf_community_areas.crs)\n\n############################################\n# 3. 提取事件点坐标并确保为float类型\n############################################\ncarjackings_points = np.array([(geom.x, geom.y) for geom in gdf_carjackings.geometry], dtype=float)\n\n############################################\n# 4. 构建研究区域多边形（study_area_poly）\n############################################\nstudy_area_poly = unary_union(gdf_community_areas.geometry)\nif study_area_poly.geom_type == 'MultiPolygon':\n    # 选取面积最大的Polygon作为研究域\n    largest_polygon = max(study_area_poly.geoms, key=lambda a: a.area)\n    study_area_poly = largest_polygon\n\n# 确保多边形坐标为float\n# 提取Polygon坐标并重建Polygon以确保浮点类型\ncoords = np.array(study_area_poly.exterior.coords, dtype=float)\nstudy_area_poly = Polygon(coords)\n\n############################################\n# 5. 定义距离序列与模拟次数，并确保为float类型\n############################################\ndistance_support = np.arange(500, 5500, 500).astype(float)\niterations = 999\n\n############################################\n# 6. 使用k_test进行K函数分析\n############################################\nresult = ds.k_test(\n    coordinates=carjackings_points,\n    support=distance_support,\n    hull=study_area_poly,\n    keep_simulations=True,\n    n_simulations=iterations\n)\n\n# 查看result属性\nprint(\"Attributes of result:\", dir(result))\n\n# 提取结果\nobs = result.statistic        # 观测K值数组\nsims = result.simulations     # 模拟K值数组 (iterations x len(distance_support))\nr = result.support            # 距离序列\n\n# 计算95%置信区间\nlower = np.percentile(sims, 2.5, axis=0)\nupper = np.percentile(sims, 97.5, axis=0)\n\nplt.figure(figsize=(10,6))\nplt.plot(r, obs, color='red', label='Observed K')\nplt.fill_between(r, lower, upper, color='gray', alpha=0.5, label='95% CI (Random Sim)')\nplt.xlabel('Distance (m)')\nplt.ylabel('K(d)')\nplt.title(\"Ripley's K Function via k_test\")\nplt.legend()\nplt.show()\n\nCarjackings CRS: EPSG:3435\nCommunity Areas CRS: GEOGCS[\"unknown\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"Degree\",0.0174532925199433],AXIS[\"Longitude\",EAST],AXIS[\"Latitude\",NORTH]]\nAfter reprojecting, Community Areas CRS: EPSG:3435\nAttributes of result: ['__add__', '__class__', '__class_getitem__', '__contains__', '__delattr__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__match_args__', '__module__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmul__', '__setattr__', '__sizeof__', '__slots__', '__str__', '__subclasshook__', '_asdict', '_field_defaults', '_fields', '_make', '_replace', 'count', 'index', 'pvalue', 'simulations', 'statistic', 'support']\n\n\n\n\n\n\n\n\n\n\n# 确保 gdf_community_areas 中有 MEDINC 列\nprint(\"Columns in gdf_community_areas:\", gdf_community_areas.columns)\n\n# 检查MEDINC描述统计并计算中位数\nprint(gdf_community_areas['MEDINC'].describe())\nmedian_income = gdf_community_areas['MEDINC'].median()\nprint(\"Median income for all communities:\", median_income)\n\n# 根据中位数划分income_group列\ngdf_community_areas['income_group'] = gdf_community_areas['MEDINC'].apply(lambda x: 'low' if x &lt; median_income else 'high')\n\n# 再次确认\nprint(\"Check if income_group column is created:\")\nprint(gdf_community_areas[['area_numbe','MEDINC','income_group']].head())\n\nColumns in gdf_community_areas: Index(['area_num_1', 'area_numbe', 'community', 'shape_area', 'shape_len',\n       'districtno', 'district', 'GEOID', 'GEOG', '2000_POP',\n       ...\n       'KOREAN', 'OTHASIAN', 'OTHER_EURO', 'OTHUNSPEC', '2000_WHITE',\n       '2000_HISP', '2000_BLACK', '2000_ASIAN', '2000_OTHER', 'geometry'],\n      dtype='object', length=217)\ncount        77.000000\nmean      56199.935065\nstd       27028.194034\nmin       15396.000000\n25%       34396.000000\n50%       51689.000000\n75%       70223.000000\nmax      125033.000000\nName: MEDINC, dtype: float64\nMedian income for all communities: 51689.0\nCheck if income_group column is created:\n   area_numbe   MEDINC income_group\n0        35.0  31856.0          low\n1        36.0  32844.0          low\n2        37.0  23148.0          low\n3        38.0  33503.0          low\n4        39.0  49114.0          low\n\n\n\ngdf_carjackings_joined['area_numbe'] = gdf_carjackings_joined['area_numbe'].fillna(-1)\n\nlow_income_areas = gdf_community_areas[gdf_community_areas['income_group'] == 'low']['area_numbe'].tolist()\nhigh_income_areas = gdf_community_areas[gdf_community_areas['income_group'] == 'high']['area_numbe'].tolist()\n\nlow_income_events = gdf_carjackings_joined[gdf_carjackings_joined['area_numbe'].isin(low_income_areas)]\nhigh_income_events = gdf_carjackings_joined[gdf_carjackings_joined['area_numbe'].isin(high_income_areas)]\n\nprint(\"Number of low-income community events:\", len(low_income_events))\nprint(\"Number of high-income community events:\", len(high_income_events))\n\nprint(\"\\nLow income events head:\")\nprint(low_income_events.head())\n\nprint(\"\\nHigh income events head:\")\nprint(high_income_events.head())\n\nNumber of low-income community events: 964\nNumber of high-income community events: 446\n\nLow income events head:\n           ID Case _mber                    Date   IUCR  \\\n0  12243012.0   JD456735  12/11/2020 11:45:00 PM  326.0   \n2  12012068.0   JD189121  03/18/2020 12:03:00 AM  326.0   \n3  12012705.0   JD189547  03/18/2020 01:00:00 PM  326.0   \n4  12013533.0   JD189766  03/18/2020 05:32:00 PM  325.0   \n5  12012624.0   JD189695  03/18/2020 01:00:00 PM  326.0   \n\n                       Descr_tion Locat_tion    Beat  District  Ward  \\\n0  AGGRAVATED VEHICULAR HIJACKING     STREET   723.0       7.0   6.0   \n2  AGGRAVATED VEHICULAR HIJACKING     STREET  1114.0      11.0  28.0   \n3  AGGRAVATED VEHICULAR HIJACKING     STREET  1114.0      11.0  28.0   \n4             VEHICULAR HIJACKING     STREET   712.0       7.0  16.0   \n5  AGGRAVATED VEHICULAR HIJACKING     STREET  1513.0      15.0  29.0   \n\n   Commu_Area  ...  ARABIC  KOREAN  OTHASIAN  OTHER_EURO  OTHUNSPEC  \\\n0        68.0  ...     0.0     0.0       1.0        76.0      170.0   \n2        26.0  ...     0.0     0.0       0.0        60.0       11.0   \n3        26.0  ...     0.0     0.0       0.0        60.0       11.0   \n4        68.0  ...     0.0     0.0       1.0        76.0      170.0   \n5        25.0  ...   146.0    15.0     120.0       530.0      373.0   \n\n  2000_WHITE  2000_HISP  2000_BLACK  2000_ASIAN 2000_OTHER  \n0      178.0      347.0     39352.0        27.0      318.0  \n2      133.0      201.0     22564.0        18.0      103.0  \n3      133.0      201.0     22564.0        18.0      103.0  \n4      178.0      347.0     39352.0        27.0      318.0  \n5     5662.0     4841.0    105369.0       642.0     1013.0  \n\n[5 rows x 233 columns]\n\nHigh income events head:\n            ID Case _mber                    Date   IUCR  \\\n1   12130750.0   JD326543  08/09/2020 08:30:00 PM  326.0   \n6   12242966.0   JD456567  12/11/2020 07:30:00 PM  326.0   \n11  12130573.0   JD326320  08/09/2020 04:22:00 PM  326.0   \n12  12013044.0   JD190170  03/19/2020 07:50:00 AM  326.0   \n15  12013595.0   JD190763  03/19/2020 08:40:00 PM  325.0   \n\n                        Descr_tion   Locat_tion    Beat  District  Ward  \\\n1   AGGRAVATED VEHICULAR HIJACKING  GAS STATION  1234.0      12.0  25.0   \n6   AGGRAVATED VEHICULAR HIJACKING       STREET  1225.0      12.0  28.0   \n11  AGGRAVATED VEHICULAR HIJACKING       STREET  1821.0      18.0   2.0   \n12  AGGRAVATED VEHICULAR HIJACKING       STREET  2222.0      22.0  21.0   \n15             VEHICULAR HIJACKING       STREET  2234.0      22.0  34.0   \n\n    Commu_Area  ...  ARABIC  KOREAN  OTHASIAN  OTHER_EURO  OTHUNSPEC  \\\n1         31.0  ...   203.0   186.0     136.0       256.0       82.0   \n6         28.0  ...   421.0   512.0    1432.0      3563.0      386.0   \n11         8.0  ...   759.0   546.0    1477.0      5747.0      517.0   \n12        73.0  ...     1.0     0.0      26.0       298.0       10.0   \n15        75.0  ...    15.0     5.0       7.0       333.0        9.0   \n\n   2000_WHITE  2000_HISP  2000_BLACK  2000_ASIAN 2000_OTHER  \n1      3587.0    39144.0       774.0       121.0      405.0  \n6     11731.0     4415.0     24546.0      4861.0      866.0  \n11    50397.0     2805.0     13884.0      4434.0     1291.0  \n12      193.0      231.0     29108.0         9.0      302.0  \n15     7510.0      533.0     16816.0        83.0      284.0  \n\n[5 rows x 233 columns]\n\n\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom shapely.ops import unary_union\nfrom shapely.geometry import Point, Polygon\nfrom pointpats import distance_statistics as ds\n\n# 首先从low_income_events和high_income_events中提取点坐标\nlow_points = np.array([(geom.x, geom.y) for geom in low_income_events.geometry], dtype=float)\nhigh_points = np.array([(geom.x, geom.y) for geom in high_income_events.geometry], dtype=float)\n\n# 使用与之前类似的距离序列和模拟次数\ndistance_support = np.arange(500, 5500, 500).astype(float)\niterations = 999\n\n############################################\n# 低收入社区事件 K函数分析\n############################################\nlow_result = ds.k_test(\n    coordinates=low_points,\n    support=distance_support,\n    hull=study_area_poly,  # 使用同一个研究区域，如有需要可只使用低收入社区的多边形集合\n    keep_simulations=True,\n    n_simulations=iterations\n)\n\nobs_low = low_result.statistic\nsims_low = low_result.simulations\nr_low = low_result.support\nlower_low = np.percentile(sims_low, 2.5, axis=0)\nupper_low = np.percentile(sims_low, 97.5, axis=0)\n\nplt.figure(figsize=(10,6))\nplt.plot(r_low, obs_low, color='red', label='Observed K (Low Income Areas)')\nplt.fill_between(r_low, lower_low, upper_low, color='gray', alpha=0.5, label='95% CI (Random)')\nplt.xlabel('Distance (m)')\nplt.ylabel('K(d)')\nplt.title(\"Ripley's K - Low Income Areas\")\nplt.legend()\nplt.show()\n\n############################################\n# 高收入社区事件 K函数分析\n############################################\nhigh_result = ds.k_test(\n    coordinates=high_points,\n    support=distance_support,\n    hull=study_area_poly, \n    keep_simulations=True,\n    n_simulations=iterations\n)\n\nobs_high = high_result.statistic\nsims_high = high_result.simulations\nr_high = high_result.support\nlower_high = np.percentile(sims_high, 2.5, axis=0)\nupper_high = np.percentile(sims_high, 97.5, axis=0)\n\nplt.figure(figsize=(10,6))\nplt.plot(r_high, obs_high, color='blue', label='Observed K (High Income Areas)')\nplt.fill_between(r_high, lower_high, upper_high, color='gray', alpha=0.5, label='95% CI (Random)')\nplt.xlabel('Distance (m)')\nplt.ylabel('K(d)')\nplt.title(\"Ripley's K - High Income Areas\")\nplt.legend()\nplt.show()\n\n############################################\n# 输出结果检查\n############################################\nprint(\"Low-income areas K-test results:\")\nprint(\"Attributes:\", dir(low_result))\nprint(\"Observations shape:\", obs_low.shape, \"Simulations shape:\", sims_low.shape)\n\nprint(\"\\nHigh-income areas K-test results:\")\nprint(\"Attributes:\", dir(high_result))\nprint(\"Observations shape:\", obs_high.shape, \"Simulations shape:\", sims_high.shape)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLow-income areas K-test results:\nAttributes: ['__add__', '__class__', '__class_getitem__', '__contains__', '__delattr__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__match_args__', '__module__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmul__', '__setattr__', '__sizeof__', '__slots__', '__str__', '__subclasshook__', '_asdict', '_field_defaults', '_fields', '_make', '_replace', 'count', 'index', 'pvalue', 'simulations', 'statistic', 'support']\nObservations shape: (10,) Simulations shape: (999, 10)\n\nHigh-income areas K-test results:\nAttributes: ['__add__', '__class__', '__class_getitem__', '__contains__', '__delattr__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__match_args__', '__module__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmul__', '__setattr__', '__sizeof__', '__slots__', '__str__', '__subclasshook__', '_asdict', '_field_defaults', '_fields', '_make', '_replace', 'count', 'index', 'pvalue', 'simulations', 'statistic', 'support']\nObservations shape: (10,) Simulations shape: (999, 10)\n\n\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# 从low_result和high_result中获取数据\nobs_low = low_result.statistic\nsims_low = low_result.simulations\nobs_high = high_result.statistic\nsims_high = high_result.simulations\nr = low_result.support  # 距离序列应当相同\n\n# 计算模拟分布均值\nmean_low = np.mean(sims_low, axis=0)\nmean_high = np.mean(sims_high, axis=0)\n\n# 归一化处理：观测值除以模拟均值\nnorm_low = obs_low / mean_low\nnorm_high = obs_high / mean_high\n\nplt.figure(figsize=(10,6))\nplt.plot(r, norm_low, color='red', label='Low Income Normalized')\nplt.plot(r, norm_high, color='blue', label='High Income Normalized')\nplt.axhline(y=1.0, color='gray', linestyle='--', label='Random Baseline')\nplt.xlabel('Distance (m)')\nplt.ylabel('Observed K / Mean Random K')\nplt.title(\"Normalized K Function Comparison\")\nplt.legend()\nplt.show()"
  }
]